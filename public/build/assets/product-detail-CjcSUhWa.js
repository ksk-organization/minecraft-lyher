import{c as _,j as e,d as z,r as g,u as B,H as O,L as R}from"./app-CevVW6uP.js";import{a as M,c as j,B as w}from"./button-BumJsOpn.js";import{I as C}from"./input-BxslwCu5.js";import{c as P,C as D,a as E,b as $}from"./card-CJFSILEw.js";import{L as N}from"./label-INPofQya.js";import{B as I}from"./badge-DVh6l5hM.js";import{L as A,S as H}from"./layout-DR7hT03U.js";import{C as y}from"./circle-check-CbMbjYR1.js";import{e as W,f as Y,T as G,d as J}from"./tooltip-DN0qq7l2.js";import{M as Q}from"./monitor-CrQPv9Ea.js";import{s as T}from"./index-BsxvijQw.js";import{L as F}from"./loader-circle-0pQLL_nO.js";import{C as X}from"./circle-alert-BaHM4PvZ.js";import{X as K}from"./x-jTX2tEsW.js";/* empty css            */import"./index-CeEMZ2R4.js";import"./FlashMessage-0d-uvwAW.js";import"./index-4zh99J10.js";const V=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],Z=M("Smartphone",V);const ee=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],te=M("Upload",ee);function se(a){const t=_.c(11),{mainImage:n,thumbnails:l,alt:o,onThumbClick:d}=a;let i;t[0]!==o||t[1]!==n?(i=e.jsx("div",{className:"relative aspect-square overflow-hidden rounded-2xl border border-white/5 bg-[#0f0f0f] shadow-2xl",children:e.jsx("img",{src:n,alt:o,className:"h-full w-full object-contain p-8 transition-transform duration-700 hover:scale-105 md:p-12",loading:"eager"})}),t[0]=o,t[1]=n,t[2]=i):i=t[2];let c;t[3]!==o||t[4]!==n||t[5]!==d||t[6]!==l?(c=l.length>1&&e.jsx("div",{className:"scrollbar-thin scrollbar-thumb-white/10 flex gap-3 overflow-x-auto pb-2",children:l.map((r,p)=>e.jsx("button",{type:"button",onClick:()=>d(r),className:j("h-20 w-20 flex-shrink-0 rounded-xl border-2 bg-[#121212] p-2 transition-all",n===r?"border-primary shadow-[0_0_15px_rgba(var(--primary),0.4)]":"border-transparent opacity-60 hover:opacity-90"),children:e.jsx("img",{src:r,alt:`${o} preview ${p+1}`,className:"h-full w-full object-contain"})},p))}),t[3]=o,t[4]=n,t[5]=d,t[6]=l,t[7]=c):c=t[7];let s;return t[8]!==i||t[9]!==c?(s=e.jsxs("div",{className:"space-y-5",children:[i,c]}),t[8]=i,t[9]=c,t[10]=s):s=t[10],s}function ae(a){const t=_.c(14),{file:n,onFileChange:l}=a;let o;t[0]!==l?(o=u=>{u.preventDefault();const f=u.dataTransfer.files[0];f?.type.startsWith("image/")&&l(f)},t[0]=l,t[1]=o):o=t[1];const d=o;let i;t[2]===Symbol.for("react.memo_cache_sentinel")?(i=e.jsx(N,{className:"text-xs font-black tracking-widest text-muted-foreground uppercase",children:"Upload Payment Proof"}),t[2]=i):i=t[2];const c=n?"border-green-600/50 bg-green-950/20":"border-white/10 bg-black/20 hover:border-primary/40";let s;t[3]!==c?(s=j("cursor-pointer rounded-2xl border-2 border-dashed p-10 text-center transition-all",c),t[3]=c,t[4]=s):s=t[4];let r;t[5]!==l?(r=e.jsx("input",{type:"file",accept:"image/*",onChange:u=>l(u.target.files?.[0]??null),className:"hidden",id:"receipt-upload"}),t[5]=l,t[6]=r):r=t[6];let p;t[7]!==n?(p=e.jsx("label",{htmlFor:"receipt-upload",className:"cursor-pointer",children:n?e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{className:"mx-auto h-10 w-10 text-green-500"}),e.jsx("p",{className:"text-sm font-medium text-green-400",children:n.name})]}):e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"mx-auto mb-3 h-8 w-8 text-muted-foreground"}),e.jsx("p",{className:"text-xs font-bold uppercase opacity-60",children:"Drop Screenshot or Click to Browse"})]})}),t[7]=n,t[8]=p):p=t[8];let x;return t[9]!==d||t[10]!==s||t[11]!==r||t[12]!==p?(x=e.jsxs("div",{className:"space-y-2",children:[i,e.jsxs("div",{onDrop:d,onDragOver:re,className:s,children:[r,p]})]}),t[9]=d,t[10]=s,t[11]=r,t[12]=p,t[13]=x):x=t[13],x}function re(a){return a.preventDefault()}function oe(a){const t=_.c(11),{finalPrice:n,platform:l}=a;let o;t[0]!==l?(o=l.toUpperCase(),t[0]=l,t[1]=o):o=t[1];let d;t[2]!==o?(d=e.jsxs("div",{className:"text-xs font-black tracking-widest uppercase opacity-50",children:["Scan to Pay (",o,")"]}),t[2]=o,t[3]=d):d=t[3];let i;t[4]===Symbol.for("react.memo_cache_sentinel")?(i=e.jsx("div",{className:"mx-auto flex justify-center ",children:e.jsx("img",{className:"max-w-68 shadow-inner rounded-2xl ",src:"/assets/qr/qr.jpg",alt:""})}),t[4]=i):i=t[4];let c;t[5]===Symbol.for("react.memo_cache_sentinel")?(c=e.jsx("span",{className:"uppercase opacity-70",children:"Total Due"}),t[5]=c):c=t[5];let s;t[6]!==n?(s=e.jsxs("div",{className:"flex items-center justify-between border-t border-white/10 pt-4 text-sm font-semibold",children:[c,e.jsxs("span",{className:"font-mono text-2xl text-primary",children:["$",n]})]}),t[6]=n,t[7]=s):s=t[7];let r;return t[8]!==d||t[9]!==s?(r=e.jsxs("div",{className:"space-y-5 rounded-2xl border border-white/5 bg-black/40 p-6 text-center",children:[d,i,s]}),t[8]=d,t[9]=s,t[10]=r):r=t[10],r}function le(a){const t=_.c(4),{value:n,onChange:l}=a;let o;t[0]===Symbol.for("react.memo_cache_sentinel")?(o=[{id:"java",label:"Java",icon:Q},{id:"bedrock",label:"Bedrock",icon:Z}],t[0]=o):o=t[0];const d=o;let i;return t[1]!==l||t[2]!==n?(i=e.jsx(W,{children:e.jsx("div",{className:"grid grid-cols-2 gap-3",children:d.map(c=>{const{id:s,label:r,icon:p}=c;return e.jsxs(Y,{children:[e.jsx(G,{asChild:!0,children:e.jsxs("button",{type:"button",onClick:()=>l(s),className:j("flex flex-col items-center gap-2 rounded-xl border p-3 transition-all",n===s?"border-primary bg-primary/10 text-primary shadow-sm":"border-white/5 bg-black/20 text-muted-foreground hover:border-white/20"),children:[e.jsx(p,{size:20}),e.jsx("span",{className:"text-xs font-black uppercase",children:r})]})}),e.jsxs(J,{children:[r," Edition"]})]},s)})})}),t[1]=l,t[2]=n,t[3]=i):i=t[3],i}function k(a){const t=Number(a??0);return Number.isFinite(t)?t.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00"}function _e({product:a}){const{flash:t}=z().props,[n,l]=g.useState(!!t?.success),o=g.useMemo(()=>{const m="https://cdn-icons-png.flaticon.com/512/2317/2317997.png",v=a.main_icon_url?`/storage/${a.main_icon_url}`:m,b=a.images?.map(h=>`/storage/${h.image_url}`)??[];return[v,...b].filter((h,L,U)=>U.indexOf(h)===L).length>0?[v,...b]:[m]},[a]),[d,i]=g.useState(o[0]),c=g.useMemo(()=>Number(a.price??0),[a.price]),s=B({product_id:a.id,minecraft_name:"",platform:"java",promo_code:"",qty:"",receipt:null}),[r,p]=g.useState(null),[x,u]=g.useState(!1);g.useEffect(()=>{const m=s.data.promo_code.trim().toUpperCase();if(!m){p(null),s.clearErrors("promo_code");return}const v=setTimeout(async()=>{u(!0);try{const b=await fetch(`${T("checkout.check-coupon")}?code=${encodeURIComponent(m)}`,{headers:{Accept:"application/json"}});if(!b.ok)throw new Error("Network response was not ok");const h=await b.json();h.valid?(p({valid:!0,discount:h.discount??0,message:h.message||`${h.discount}% off applied`}),s.clearErrors("promo_code")):(p({valid:!1,discount:0,message:h.message||"Invalid or expired code"}),s.setError("promo_code",h.message||"Invalid code"))}catch{p({valid:!1,discount:0,message:"Error checking code. Try again."}),s.setError("promo_code","Network or server error")}finally{u(!1)}},600);return()=>clearTimeout(v)},[s.data.promo_code]);const f=r?.valid?r.discount:0,S=k(Math.max(0,c*(1-f/100))),q=m=>{if(m.preventDefault(),!s.data.minecraft_name.trim()){s.setError("minecraft_name","Minecraft username is required");return}if(!s.data.receipt){s.setError("receipt","Please upload a payment receipt");return}if(a.stock<=0){s.setError("general","Product is out of stock");return}s.post(T("payment.store"),{preserveScroll:!0,onSuccess:()=>{l(!0)}})};return e.jsxs(A,{children:[e.jsx(O,{title:`NOMROTI | ${a.name}`}),e.jsx("main",{className:"container max-w-7xl mx-auto mt-8 px-5 py-10 md:px-6 md:py-16",children:e.jsxs("div",{className:"grid gap-10 lg:grid-cols-2 lg:gap-16",children:[e.jsx(se,{mainImage:d,thumbnails:o,alt:a.name,onThumbClick:i}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("header",{className:"space-y-2",children:[e.jsx("h1",{className:"text-3xl font-black tracking-tight text-white uppercase italic md:text-4xl",children:a.name}),e.jsxs("div",{className:"flex flex-wrap items-baseline gap-4",children:[e.jsx("span",{className:"font-mono text-3xl font-bold text-primary md:text-4xl",children:k(f?S:c)}),f>0&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-xl text-muted-foreground line-through opacity-70 md:text-2xl",children:["$",k(c)]}),e.jsxs(I,{className:"border-green-500/40 bg-green-600/30 text-green-400",children:["-",f,"%"]})]}),e.jsx(I,{variant:"outline",className:j("ml-2",a.stock>0?"border-green-600/40 bg-green-950/30 text-green-400":"border-red-600/40 bg-red-950/30 text-red-400"),children:a.stock>0?`${a.stock} in stock`:"Out of stock"})]}),a.short_description&&e.jsx("p",{className:"text-md leading-relaxed text-zinc-300",children:a.short_description})]}),e.jsxs(P,{className:"border-white/5 bg-gradient-to-b from-[#1a1a1a] to-[#121212] shadow-2xl gap-0",children:[e.jsx(D,{className:"pt-6",children:e.jsx(E,{className:"text-xl font-black tracking-wide uppercase",children:"Complete Your Purchase"})}),e.jsx($,{className:"space-y-6 p-6 md:p-8",children:e.jsxs("form",{onSubmit:q,className:"space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"minecraft_name",className:"text-xs font-black tracking-widest text-muted-foreground uppercase",children:"Minecraft Username (IGN)"}),e.jsxs("div",{className:"relative",children:[e.jsx(C,{id:"minecraft_name",value:s.data.minecraft_name,onChange:m=>s.setData("minecraft_name",m.target.value.trim()),placeholder:"Your in-game name",className:"h-10 border-white/10 bg-black/30 pr-10",disabled:s.processing}),s.data.minecraft_name.length>2&&!s.errors.minecraft_name&&e.jsx(y,{className:"absolute top-1/2 right-3 h-5 w-5 -translate-y-1/2 text-green-500"})]}),s.errors.minecraft_name&&e.jsx("p",{className:"text-sm text-red-400",children:s.errors.minecraft_name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"minecraft_name",className:"text-xs font-black tracking-widest text-muted-foreground uppercase",children:"Quantity"}),e.jsxs("div",{className:"relative",children:[e.jsx(C,{id:"qty",value:s.data.qty,onChange:m=>s.setData("qty",m.target.value.trim()),placeholder:"eg. 1",className:"h-10 border-white/10 bg-black/30 pr-10",disabled:s.processing,type:"number"}),s.data.qty.length>2&&!s.errors.qty&&e.jsx(y,{className:"absolute top-1/2 right-3 h-5 w-5 -translate-y-1/2 text-green-500"})]}),s.errors.qty&&e.jsx("p",{className:"text-sm text-red-400",children:s.errors.qty})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{className:"text-xs font-black tracking-widest text-muted-foreground uppercase",children:"Platform"}),e.jsx(le,{value:s.data.platform,onChange:m=>s.setData("platform",m),disabled:s.processing})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{className:"text-xs font-black tracking-widest text-muted-foreground uppercase",children:"Promo Code"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(C,{value:s.data.promo_code,onChange:m=>s.setData("promo_code",m.target.value.toUpperCase()),placeholder:"e.g. WELCOME10",className:j("h-10 border-white/10 bg-black/30 pr-10 transition-colors",r?.valid&&"border-green-500/60",r?.valid===!1&&s.data.promo_code&&"border-red-500/60"),disabled:s.processing||x}),x&&e.jsx(F,{className:"absolute top-1/2 right-3 h-5 w-5 -translate-y-1/2 animate-spin text-muted-foreground"}),!x&&r?.valid&&e.jsx(y,{className:"absolute top-1/2 right-3 h-5 w-5 -translate-y-1/2 text-green-500"}),!x&&r?.valid===!1&&s.data.promo_code&&e.jsx(X,{className:"absolute top-1/2 right-3 h-5 w-5 -translate-y-1/2 text-red-500"})]}),e.jsx(w,{type:"button",variant:"secondary",size:"sm",onClick:()=>s.setData("promo_code",s.data.promo_code.trim().toUpperCase()),disabled:s.processing||x||!s.data.promo_code.trim(),className:"h-10 px-6",children:"Apply"})]}),r&&e.jsx("p",{className:j("mt-1.5 text-sm",r.valid?"text-green-400":"text-red-400"),children:r.message}),s.errors.promo_code&&e.jsx("p",{className:"text-sm text-red-400",children:s.errors.promo_code})]}),e.jsx(oe,{finalPrice:S,platform:s.data.platform}),e.jsx(ae,{file:s.data.receipt,onFileChange:m=>s.setData("receipt",m),disabled:s.processing}),s.errors.receipt&&e.jsx("p",{className:"text-sm text-red-400",children:s.errors.receipt}),s.errors.general&&e.jsx("p",{className:"text-center text-red-400",children:s.errors.general}),e.jsx(w,{type:"submit",disabled:s.processing||a.stock<=0,className:"h-14 w-full bg-primary text-lg font-black tracking-wider uppercase hover:bg-primary/90",children:s.processing?e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"mr-2 h-5 w-5 animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"mr-2 h-5 w-5"}),"Submit Payment"]})})]})})]}),a.long_description&&e.jsxs(P,{className:"border-white/5 bg-[#1a1a1a] shadow-xl",children:[e.jsx(D,{children:e.jsx(E,{className:"text-lg font-black uppercase",children:"Product Details"})}),e.jsx($,{className:"leading-relaxed whitespace-pre-line text-zinc-300",children:a.long_description})]})]})]})}),n&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-4 backdrop-blur-sm",children:e.jsxs("div",{className:"relative w-full max-w-md rounded-2xl border border-green-500/30 bg-gradient-to-b from-[#1a2a1a] to-[#121f12] p-8 shadow-2xl",children:[e.jsx("button",{onClick:()=>l(!1),className:"absolute top-5 right-5 text-zinc-400 hover:text-white","aria-label":"Close",children:e.jsx(K,{size:24})}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-6 flex h-20 w-20 items-center justify-center rounded-full bg-green-900/40",children:e.jsx(y,{className:"h-10 w-12 text-green-500"})}),e.jsx("h2",{className:"mb-4 text-3xl font-black text-white",children:"Payment Submitted!"}),e.jsx("p",{className:"mb-8 text-lg text-zinc-300",children:t?.success||"Your receipt has been received. We will verify it shortly and activate your order."}),e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:justify-center",children:[e.jsx(w,{variant:"outline",onClick:()=>l(!1),className:"border-green-600/50 text-green-400 hover:bg-green-950/50",children:"Close"}),e.jsx(w,{asChild:!0,className:"bg-green-600 hover:bg-green-700",children:e.jsx(R,{href:"/products",onClick:()=>l(!1),children:"Back to Catalog"})})]})]})]})})]})}export{_e as default};
