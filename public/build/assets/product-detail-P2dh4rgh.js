import{c as S,j as e,d as R,r as g,u as W,H as G,L as J}from"./app-si8xdoL5.js";import{a as B,c as y,B as v}from"./button-BS_WtdaB.js";import{I}from"./input-CkuxkP8h.js";import{c as T,C as q,a as z,b as F}from"./card-D6FZvwG6.js";import{L as w}from"./label--yJ_Ietz.js";import{B as U}from"./badge-8aDXQBT1.js";import{L as V,S as X}from"./layout-B5ziacfS.js";import{C}from"./circle-check-BqdGVyZ9.js";import{e as Y,f as K,T as Z,d as ee}from"./tooltip-UMoC5d0b.js";import{M as te}from"./monitor-CBma74P6.js";import{s as L}from"./index-BsxvijQw.js";import{M as se}from"./minus-BlNygsji.js";import{P as re}from"./plus-DGeHXlph.js";import{L as A}from"./loader-circle-orrvZ0UI.js";import{C as ae}from"./circle-alert-Daiv3m_w.js";import{X as ne}from"./x-CG9rMSE1.js";/* empty css            */import"./index-BNG-m0Zv.js";import"./FlashMessage-CdoxWaqN.js";import"./index-CujMS4ut.js";const ie=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],oe=B("Smartphone",ie);const le=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],ce=B("Upload",le);function de(r){const t=S.c(11),{mainImage:c,thumbnails:i,alt:n,onThumbClick:x}=r;let o;t[0]!==n||t[1]!==c?(o=e.jsx("div",{className:"relative aspect-square overflow-hidden rounded-2xl border border-white/5 bg-[#0f0f0f] shadow-2xl",children:e.jsx("img",{src:c,alt:n,className:"h-full w-full object-contain p-8 transition-transform duration-700 hover:scale-105 md:p-12",loading:"eager"})}),t[0]=n,t[1]=c,t[2]=o):o=t[2];let m;t[3]!==n||t[4]!==c||t[5]!==x||t[6]!==i?(m=i.length>1&&e.jsx("div",{className:"scrollbar-thin scrollbar-thumb-white/10 flex gap-3 overflow-x-auto pb-2",children:i.map((d,h)=>e.jsx("button",{type:"button",onClick:()=>x(d),className:y("h-20 w-20 flex-shrink-0 rounded-xl border-2 bg-[#121212] p-2 transition-all",c===d?"border-primary shadow-[0_0_15px_rgba(var(--primary),0.4)]":"border-transparent opacity-60 hover:opacity-90"),children:e.jsx("img",{src:d,alt:`${n} preview ${h+1}`,className:"h-full w-full object-contain"})},h))}),t[3]=n,t[4]=c,t[5]=x,t[6]=i,t[7]=m):m=t[7];let a;return t[8]!==o||t[9]!==m?(a=e.jsxs("div",{className:"space-y-5",children:[o,m]}),t[8]=o,t[9]=m,t[10]=a):a=t[10],a}function me(r){const t=S.c(14),{file:c,onFileChange:i}=r;let n;t[0]!==i?(n=s=>{s.preventDefault();const p=s.dataTransfer.files[0];p?.type.startsWith("image/")&&i(p)},t[0]=i,t[1]=n):n=t[1];const x=n;let o;t[2]===Symbol.for("react.memo_cache_sentinel")?(o=e.jsx(w,{className:"text-xs font-black tracking-widest text-muted-foreground uppercase",children:"Upload Payment Proof"}),t[2]=o):o=t[2];const m=c?"border-green-600/50 bg-green-950/20":"border-white/10 bg-black/20 hover:border-primary/40";let a;t[3]!==m?(a=y("cursor-pointer rounded-2xl border-2 border-dashed p-10 text-center transition-all",m),t[3]=m,t[4]=a):a=t[4];let d;t[5]!==i?(d=e.jsx("input",{type:"file",accept:"image/*",onChange:s=>i(s.target.files?.[0]??null),className:"hidden",id:"receipt-upload"}),t[5]=i,t[6]=d):d=t[6];let h;t[7]!==c?(h=e.jsx("label",{htmlFor:"receipt-upload",className:"cursor-pointer",children:c?e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{className:"mx-auto h-10 w-10 text-green-500"}),e.jsx("p",{className:"text-sm font-medium text-green-400",children:c.name})]}):e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"mx-auto mb-3 h-8 w-8 text-muted-foreground"}),e.jsx("p",{className:"text-xs font-bold uppercase opacity-60",children:"Drop Screenshot or Click to Browse"})]})}),t[7]=c,t[8]=h):h=t[8];let N;return t[9]!==x||t[10]!==a||t[11]!==d||t[12]!==h?(N=e.jsxs("div",{className:"space-y-2",children:[o,e.jsxs("div",{onDrop:x,onDragOver:pe,className:a,children:[d,h]})]}),t[9]=x,t[10]=a,t[11]=d,t[12]=h,t[13]=N):N=t[13],N}function pe(r){return r.preventDefault()}function xe(r){const t=S.c(11),{finalPrice:c,platform:i}=r;let n;t[0]!==i?(n=i.toUpperCase(),t[0]=i,t[1]=n):n=t[1];let x;t[2]!==n?(x=e.jsxs("div",{className:"text-xs font-black tracking-widest uppercase opacity-50",children:["Scan to Pay (",n,")"]}),t[2]=n,t[3]=x):x=t[3];let o;t[4]===Symbol.for("react.memo_cache_sentinel")?(o=e.jsx("div",{className:"mx-auto flex justify-center ",children:e.jsx("img",{className:"max-w-68 shadow-inner rounded-2xl ",src:"/assets/qr/qr.jpg",alt:""})}),t[4]=o):o=t[4];let m;t[5]===Symbol.for("react.memo_cache_sentinel")?(m=e.jsx("span",{className:"uppercase opacity-70",children:"Total Due"}),t[5]=m):m=t[5];let a;t[6]!==c?(a=e.jsxs("div",{className:"flex items-center justify-between border-t border-white/10 pt-4 text-sm font-semibold",children:[m,e.jsxs("span",{className:"font-mono text-2xl text-primary",children:["$",c]})]}),t[6]=c,t[7]=a):a=t[7];let d;return t[8]!==x||t[9]!==a?(d=e.jsxs("div",{className:"space-y-5 rounded-2xl border border-white/5 bg-black/40 p-6 text-center",children:[x,o,a]}),t[8]=x,t[9]=a,t[10]=d):d=t[10],d}function ue(r){const t=S.c(4),{value:c,onChange:i}=r;let n;t[0]===Symbol.for("react.memo_cache_sentinel")?(n=[{id:"java",label:"Java",icon:te},{id:"bedrock",label:"Bedrock",icon:oe}],t[0]=n):n=t[0];const x=n;let o;return t[1]!==i||t[2]!==c?(o=e.jsx(Y,{children:e.jsx("div",{className:"grid grid-cols-2 gap-3",children:x.map(m=>{const{id:a,label:d,icon:h}=m;return e.jsxs(K,{children:[e.jsx(Z,{asChild:!0,children:e.jsxs("button",{type:"button",onClick:()=>i(a),className:y("flex flex-col items-center gap-2 rounded-xl border p-3 transition-all",c===a?"border-primary bg-primary/10 text-primary shadow-sm":"border-white/5 bg-black/20 text-muted-foreground hover:border-white/20"),children:[e.jsx(h,{size:20}),e.jsx("span",{className:"text-xs font-black uppercase",children:d})]})}),e.jsxs(ee,{children:[d," Edition"]})]},a)})})}),t[1]=i,t[2]=c,t[3]=o):o=t[3],o}function _(r){return Number.isFinite(r)?r.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00"}function qe({product:r}){const{flash:t}=R().props,[c,i]=g.useState(!!t?.success),n=g.useMemo(()=>{const l="https://cdn-icons-png.flaticon.com/512/2317/2317997.png",f=r.main_icon_url?`/storage/${r.main_icon_url}`:l,b=r.images?.map(u=>`/storage/${u.image_url}`)??[];return[f,...b].filter((u,H,Q)=>Q.indexOf(u)===H).length>0?[f,...b]:[l]},[r]),[x,o]=g.useState(n[0]),m=g.useMemo(()=>Number(r.price??0),[r.price]),[a,d]=g.useState(1),h=()=>{a<r.stock&&d(l=>l+1)},N=()=>{a>1&&d(l=>l-1)},s=W({product_id:r.id,minecraft_name:"",platform:"java",promo_code:"",qty:"1",receipt:null});g.useEffect(()=>{s.setData("qty",String(a))},[a]);const[p,k]=g.useState(null),[P,M]=g.useState(!1);g.useEffect(()=>{const l=s.data.promo_code.trim().toUpperCase();if(!l){k(null),s.clearErrors("promo_code");return}const f=setTimeout(async()=>{M(!0);try{const b=await fetch(`${L("checkout.check-coupon")}?code=${encodeURIComponent(l)}`,{headers:{Accept:"application/json"}});if(!b.ok)throw new Error("Network error");const u=await b.json();console.log("Coupon response:",u),u.valid?(k({valid:!0,discount:Number(u.discount)||0,type:u.type||"fixed",min_spend:u.min_spend?Number(u.min_spend):null,message:u.message||"",code:u.code}),s.clearErrors("promo_code")):(k({valid:!1,discount:0,type:"fixed",min_spend:null,message:u.message||"Invalid or expired code",code:u.code}),s.setError("promo_code",u.message||"Invalid code"))}catch{k({valid:!1,discount:0,type:"fixed",min_spend:null,message:"Error checking code. Try again.",code:void 0}),s.setError("promo_code","Network or server error")}finally{M(!1)}},600);return()=>clearTimeout(f)},[s.data.promo_code]);const j=g.useMemo(()=>m*a,[m,a]),$=g.useMemo(()=>{if(!p?.valid)return 0;const{type:l,discount:f,min_spend:b}=p;return b&&j<b?0:l==="percent"?j*(f/100):Math.min(f,j)},[p,j]),D=Math.max(0,j-$),E=g.useMemo(()=>!p?.valid||!p.min_spend?null:j<p.min_spend?`Minimum spend of $${_(p.min_spend)} required to use this coupon.`:null,[p,j]),O=l=>{if(l.preventDefault(),!s.data.minecraft_name.trim()){s.setError("minecraft_name","Minecraft username is required");return}if(!s.data.receipt){s.setError("receipt","Please upload a payment receipt");return}if(r.stock<=0){s.setError("general","Product is out of stock");return}if(a<1||a>r.stock){s.setError("qty",`Quantity must be between 1 and ${r.stock}`);return}s.post(L("payment.store"),{preserveScroll:!0,onSuccess:()=>{i(!0)}})};return e.jsxs(V,{children:[e.jsx(G,{title:`NOMROTI | ${r.name}`}),e.jsx("main",{className:"container max-w-7xl mx-auto mt-8 px-5 py-10 md:px-6 md:py-16",children:e.jsxs("div",{className:"grid gap-10 lg:grid-cols-2 lg:gap-16",children:[e.jsx(de,{mainImage:x,thumbnails:n,alt:r.name,onThumbClick:o}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("header",{className:"space-y-2",children:[e.jsx("h1",{className:"text-3xl font-black tracking-tight text-white uppercase italic md:text-4xl",children:r.name}),e.jsxs("div",{className:"flex flex-wrap items-baseline gap-4",children:[e.jsxs("span",{className:"font-mono text-3xl font-bold text-primary md:text-4xl",children:["$",_(D)]}),$>0&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-xl text-muted-foreground line-through opacity-70 md:text-2xl",children:["$",_(j)]}),e.jsx(U,{className:"border-green-500/40 bg-green-600/30 text-green-400",children:p?.type==="percent"?`-${p.discount}%`:`-$${_($)}`})]}),e.jsx(U,{variant:"outline",className:y("ml-2",r.stock>0?"border-green-600/40 bg-green-950/30 text-green-400":"border-red-600/40 bg-red-950/30 text-red-400"),children:r.stock>0?`${r.stock} in stock`:"Out of stock"})]}),E&&e.jsx("p",{className:"text-sm text-amber-400 font-medium mt-1",children:E}),r.short_description&&e.jsx("p",{className:"text-md leading-relaxed text-zinc-300",children:r.short_description})]}),e.jsxs(T,{className:"overflow-hidden border-white/5 bg-[#0f0f0f] shadow-[0_32px_64px_-15px_rgba(0,0,0,0.6)]",children:[e.jsx("div",{className:"h-1 w-full bg-gradient-to-r from-primary/50 via-primary to-transparent"}),e.jsx(q,{className:"pt-8 px-8",children:e.jsx(z,{className:"text-sm font-black tracking-[0.3em] uppercase text-white/90",children:"Secure Checkout"})}),e.jsx(F,{className:"space-y-6 p-8",children:e.jsxs("form",{onSubmit:O,className:"space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(w,{htmlFor:"qty",className:"text-[10px] font-black tracking-widest text-muted-foreground uppercase",children:"Quantity"}),e.jsxs("div",{className:"flex h-12 items-center rounded-xl border border-white/10 bg-black/40 p-1 focus-within:border-primary/50 transition-colors",children:[e.jsx(v,{type:"button",variant:"ghost",size:"icon",className:"h-full w-12 rounded-lg hover:bg-white/5",onClick:N,disabled:a<=1||s.processing,children:e.jsx(se,{size:14})}),e.jsx("input",{id:"qty",type:"number",min:"1",max:r.stock,value:a,onChange:l=>{const f=Number(l.target.value);!isNaN(f)&&f>=1&&f<=r.stock&&d(f)},className:"h-full w-full bg-transparent text-center text-sm font-bold outline-none [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",disabled:s.processing||r.stock<=0}),e.jsx(v,{type:"button",variant:"ghost",size:"icon",className:"h-full w-12 rounded-lg hover:bg-white/5",onClick:h,disabled:a>=r.stock||s.processing,children:e.jsx(re,{size:14})})]}),s.errors.qty&&e.jsx("p",{className:"text-xs font-medium text-red-400",children:s.errors.qty})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(w,{htmlFor:"minecraft_name",className:"text-[10px] font-black tracking-widest text-muted-foreground uppercase",children:"Minecraft Username"}),e.jsxs("div",{className:"relative group",children:[e.jsx(I,{id:"minecraft_name",value:s.data.minecraft_name,onChange:l=>s.setData("minecraft_name",l.target.value.trim()),placeholder:"Enter IGN",className:"h-12 border-white/10 bg-black/40 px-4 rounded-xl focus:ring-1 focus:ring-primary/40 transition-all",disabled:s.processing}),e.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2",children:s.data.minecraft_name.length>2&&!s.errors.minecraft_name&&e.jsx(C,{className:"h-4 w-4 text-green-500 animate-in zoom-in"})})]}),s.errors.minecraft_name&&e.jsx("p",{className:"text-xs font-medium text-red-400",children:s.errors.minecraft_name})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(w,{className:"text-[10px] font-black tracking-widest text-muted-foreground uppercase",children:"Platform"}),e.jsx(ue,{value:s.data.platform,onChange:l=>s.setData("platform",l),disabled:s.processing})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(w,{className:"text-[10px] font-black tracking-widest text-muted-foreground uppercase",children:"Promo Code"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(I,{value:s.data.promo_code,onChange:l=>s.setData("promo_code",l.target.value.toUpperCase()),placeholder:"HAVE A COUPON?",className:y("h-12 border-white/10 bg-black/40 pr-10 rounded-xl transition-all",p?.valid&&"border-green-500/40 bg-green-500/5",p?.valid===!1&&s.data.promo_code&&"border-red-500/40"),disabled:s.processing||P}),e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:P?e.jsx(A,{className:"h-4 w-4 animate-spin text-muted-foreground"}):p?.valid?e.jsx(C,{className:"h-4 w-4 text-green-500"}):p?.valid===!1&&s.data.promo_code?e.jsx(ae,{className:"h-4 w-4 text-red-500"}):null})]}),e.jsx(v,{type:"button",variant:"secondary",onClick:()=>s.setData("promo_code",s.data.promo_code.trim().toUpperCase()),disabled:s.processing||P||!s.data.promo_code.trim(),className:"h-12 px-6 rounded-xl font-bold uppercase tracking-tighter",children:"Apply"})]}),p&&e.jsx("p",{className:y("text-[11px] font-bold px-1",p.valid?"text-green-400":"text-red-400"),children:p.message})]}),e.jsxs("div",{className:"rounded-2xl bg-white/[0.02] border border-white/5 p-6 space-y-6",children:[e.jsx(xe,{finalPrice:D,platform:s.data.platform}),e.jsxs("div",{className:"pt-2",children:[e.jsx(me,{file:s.data.receipt,onFileChange:l=>s.setData("receipt",l),disabled:s.processing}),s.errors.receipt&&e.jsx("p",{className:"mt-2 text-xs font-medium text-red-400",children:s.errors.receipt})]})]}),s.errors.general&&e.jsx("div",{className:"rounded-lg bg-red-500/10 p-3 border border-red-500/20",children:e.jsx("p",{className:"text-center text-xs font-bold text-red-400 uppercase tracking-tight",children:s.errors.general})}),e.jsxs(v,{type:"submit",disabled:s.processing||r.stock<=0,className:"group relative h-16 w-full overflow-hidden bg-primary rounded-xl transition-all hover:ring-2 hover:ring-primary/20 active:scale-[0.98]",children:[e.jsx("div",{className:"relative z-10 flex items-center justify-center gap-3",children:s.processing?e.jsx(A,{className:"h-5 w-5 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"h-5 w-5 transition-transform group-hover:-translate-x-1"}),e.jsx("span",{className:"text-lg font-black tracking-widest uppercase italic",children:"Confirm & Pay"})]})}),e.jsx("div",{className:"absolute inset-0 translate-x-[-100%] bg-gradient-to-r from-transparent via-white/10 to-transparent transition-transform duration-500 group-hover:translate-x-[100%]"})]})]})})]}),r.long_description&&e.jsxs(T,{className:"border-white/5 bg-[#1a1a1a] shadow-xl",children:[e.jsx(q,{children:e.jsx(z,{className:"text-lg font-black uppercase",children:"Product Details"})}),e.jsx(F,{className:"leading-relaxed whitespace-pre-line text-zinc-300",children:r.long_description})]})]})]})}),c&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-4 backdrop-blur-sm",children:e.jsxs("div",{className:"relative w-full max-w-md rounded-2xl border border-green-500/30 bg-gradient-to-b from-[#1a2a1a] to-[#121f12] p-8 shadow-2xl",children:[e.jsx("button",{onClick:()=>i(!1),className:"absolute top-5 right-5 text-zinc-400 hover:text-white","aria-label":"Close",children:e.jsx(ne,{size:24})}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-6 flex h-20 w-20 items-center justify-center rounded-full bg-green-900/40",children:e.jsx(C,{className:"h-10 w-12 text-green-500"})}),e.jsx("h2",{className:"mb-4 text-3xl font-black text-white",children:"Payment Submitted!"}),e.jsx("p",{className:"mb-8 text-lg text-zinc-300",children:t?.success||"Your receipt has been received. We will verify it shortly and activate your order."}),e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:justify-center",children:[e.jsx(v,{variant:"outline",onClick:()=>i(!1),className:"border-green-600/50 text-green-400 hover:bg-green-950/50",children:"Close"}),e.jsx(v,{asChild:!0,className:"bg-green-600 hover:bg-green-700",children:e.jsx(J,{href:"/products",onClick:()=>i(!1),children:"Back to Catalog"})})]})]})]})})]})}export{qe as default};
